<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ë°¸ëŸ°ìŠ¤ ê²Œì„ - ì‹¤ì‹œê°„ íˆ¬í‘œ</title>
    <link href="https://hangeul.pstatic.net/hangeul_static/css/nanum-square.css" rel="stylesheet">
    <style>
        /* ìŠ¤íƒ€ì¼ì€ ì•„ê¹Œì™€ ë™ì¼í•˜ì§€ë§Œ ì¡°ê¸ˆ ë” ë‹¤ë“¬ìŒ */
        body {
            background-color: #121212;
            color: #ffffff;
            font-family: 'NanumSquare', sans-serif;
            margin: 0; padding: 0;
            text-align: center;
        }
        header {
            padding: 30px 20px;
            background: linear-gradient(135deg, #ff0055, #0055ff);
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.6);
        }
        h1 { margin: 0; font-size: 1.8rem; font-weight: 800; font-style: italic; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        p.subtitle { margin-top: 8px; font-size: 1rem; opacity: 0.9; }

        .container { max-width: 600px; margin: 0 auto; padding: 0 15px; }

        .game-card {
            background-color: #1e1e1e;
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 40px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            border: 1px solid #333;
            transition: transform 0.2s;
        }
        .game-card:hover { transform: translateY(-5px); border-color: #555; }

        .question-title { font-size: 1.3rem; font-weight: bold; margin-bottom: 20px; color: #fff; text-align: left; border-left: 4px solid #ff0055; padding-left: 10px;}

        .vs-container { display: flex; justify-content: space-between; gap: 10px; margin-bottom: 20px; }
        .option-box {
            flex: 1; background-color: #2c2c2c; border-radius: 12px;
            overflow: hidden; position: relative; cursor: pointer;
        }
        .option-img {
            width: 100%; height: 160px; object-fit: cover;
            background-color: #333; display: flex; align-items: center; justify-content: center; font-size: 3rem;
        }
        .option-label { padding: 15px 5px; font-size: 0.95rem; font-weight: bold; line-height: 1.4; color: #ddd;}

        .btn-group { display: flex; gap: 10px; }
        .vote-btn {
            flex: 1; padding: 15px; border: none; border-radius: 10px;
            font-weight: bold; font-size: 1rem; cursor: pointer; transition: 0.2s;
            color: white; box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        .btn-a { background: #ff0055; }
        .btn-b { background: #0055ff; }
        .vote-btn:active { transform: scale(0.95); }
        .vote-btn:disabled { opacity: 0.4; cursor: not-allowed; filter: grayscale(100%); }

        .result-bar-container {
            margin-top: 20px; background-color: #333; border-radius: 50px;
            height: 30px; overflow: hidden; position: relative; display: none;
        }
        .bar-fill-a { background-color: #ff0055; height: 100%; width: 50%; float: left; transition: width 0.8s ease-out; }
        .bar-text {
            position: absolute; width: 100%; height: 100%; display: flex; justify-content: space-between; align-items: center;
            padding: 0 15px; box-sizing: border-box; font-size: 0.85rem; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }
        
        .loading { color: #888; margin-top: 10px; display: none; }

        footer { margin-top: 60px; padding-bottom: 40px; color: #666; font-size: 0.8rem; line-height: 1.6; }
        .cta-box { background: #222; padding: 20px; border-radius: 10px; margin-top: 20px; }
        .cta-btn { background: white; color: black; padding: 10px 20px; border-radius: 20px; text-decoration: none; font-weight: bold; display: inline-block; margin-top: 10px;}
    </style>
</head>
<body>

    <header>
        <h1>âš–ï¸ ê·¹ì•…ì˜ ë°¸ëŸ°ìŠ¤ ê²Œì„</h1>
        <p class="subtitle">ë‹¹ì‹ ì˜ ì„ íƒì€ ìƒìœ„ ëª‡ %ì¼ê¹Œìš”?</p>
    </header>

    <div class="container" id="quiz-container">
        </div>

    <div class="container">
        <div class="cta-box">
            <h3>ë§¤ì¼ ìƒˆë¡œìš´ ë¬¸ì œê°€ ì˜¬ë¼ì˜µë‹ˆë‹¤!</h3>
            <p>ìœ íŠœë¸Œ ì±„ë„ êµ¬ë…í•˜ê³  ì•Œë¦¼ ë°›ìœ¼ì„¸ìš”</p>
            <a href="YOUR_YOUTUBE_LINK" class="cta-btn">ìœ íŠœë¸Œ êµ¬ë…í•˜ê¸° â–¶</a>
        </div>
    </div>

    <footer>
        <p>Â© 2024 AI Balance Game Project.<br>Designed for MVP Presentation.</p>
    </footer>

    <script type="module">
        // -----------------------------------------------------------
        // 1. Firebase ì„¤ì • (ë„¤ê°€ ë°œê¸‰ë°›ì€ í‚¤ë¥¼ ì—¬ê¸°ì— ë„£ì–´ì•¼ í•´!)
        // -----------------------------------------------------------
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, getDoc, updateDoc, increment, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDOVsnq_Hwkwq0UXUhrO1QB50_idyz5-Z8",
            authDomain: "webweb-a0c33.firebaseapp.com",
            projectId: "webweb-a0c33",
            storageBucket: "webweb-a0c33.firebasestorage.app",
            messagingSenderId: "632200171644",
            appId: "1:632200171644:web:614f78c7c9ec8669c0f9f9",
            measurementId: "G-N3G610NRDE"
        };

        // Firebase ì´ˆê¸°í™” (í‚¤ê°€ ì—†ìœ¼ë©´ ì‘ë™ ì•ˆ í•¨. ì¼ë‹¨ ê°€ì§œ DBë¡œ ì‘ë™í•˜ê²Œ ì˜ˆì™¸ì²˜ë¦¬ í•´ë‘ )
        let db;
        try {
            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
        } catch (e) {
            console.log("Firebase ì„¤ì •ì´ ì•„ì§ ì•ˆ ë˜ì—ˆìŠµë‹ˆë‹¤. ë¡œì»¬ ëª¨ë“œë¡œ ë™ì‘í•©ë‹ˆë‹¤.");
        }

        // -----------------------------------------------------------
        // 2. ë¬¸ì œ ë°ì´í„° (6ê°œë¡œ í™•ì¥)
        // -----------------------------------------------------------
        const questions = [
            { id: "q1", title: "Q1. ì—°ì•  ìŠ¤íƒ€ì¼", a: "ì‹¸ìš¸ ë•Œë§ˆë‹¤ ì˜¤ì—´", b: "ì‹¸ìš°ë©´ ì—°ë½ë‘ì ˆ", imgA: "ğŸ˜­", imgB: "ğŸ¤" },
            { id: "q2", title: "Q2. ìµœì•…ì˜ ì‹ì‚¬", a: "ì–‘ë… ì—†ëŠ” ë–¡ë³¶ì´", b: "êµ­ë¬¼ ì—†ëŠ” êµ­ìˆ˜", imgA: "âšª", imgB: "ğŸŒµ" },
            { id: "q3", title: "Q3. ë‹¤ì‹œ íƒœì–´ë‚œë‹¤ë©´", a: "ê·¹ë‹¨ì  ë§ˆë¦„(í•´ê³¨)", b: "ê·¹ë‹¨ì  ëš±ëš±(ê³µ)", imgA: "ğŸ’€", imgB: "ğŸˆ" },
            { id: "q4", title: "Q4. ìœ¡ì•„ ë‚œì´ë„", a: "5ì‚´ í›ˆì´ 10ëª…", b: "10ì‚´ ì§±êµ¬ 1ëª…", imgA: "ğŸ‘¶", imgB: "ğŸ‘¦" },
            { id: "q5", title: "Q5. ìœ„ìƒ ê´€ë…", a: "í‰ìƒ ì–‘ì¹˜ ì•ˆ í•˜ê¸°", b: "í‰ìƒ ìƒ¤ì›Œ ì•ˆ í•˜ê¸°", imgA: "ğŸ¦·", imgB: "ğŸš¿" },
            { id: "q6", title: "Q6. ì´ˆëŠ¥ë ¥", a: "ë‚¨ ì†ë§ˆìŒ ë‹¤ ë“¤ë¦¼", b: "ë‚´ ì†ë§ˆìŒ ë‹¤ ë“¤í‚´", imgA: "ğŸ‘‚", imgB: "ğŸ“¢" }
        ];

        // -----------------------------------------------------------
        // 3. í™”ë©´ ê·¸ë¦¬ê¸° ë° ë¡œì§
        // -----------------------------------------------------------
        const container = document.getElementById('quiz-container');

        // ì´ˆê¸° í™”ë©´ ë Œë”ë§
        questions.forEach(q => {
            const html = `
                <div class="game-card" id="${q.id}">
                    <div class="question-title">${q.title}</div>
                    <div class="vs-container">
                        <div class="option-box" onclick="handleVote('${q.id}', 'A')">
                            <div class="option-img">${q.imgA}</div>
                            <div class="option-label">${q.a}</div>
                        </div>
                        <div class="option-box" onclick="handleVote('${q.id}', 'B')">
                            <div class="option-img">${q.imgB}</div>
                            <div class="option-label">${q.b}</div>
                        </div>
                    </div>
                    <div class="btn-group">
                        <button class="vote-btn btn-a" id="btn-a-${q.id}" onclick="handleVote('${q.id}', 'A')">A ì„ íƒ</button>
                        <button class="vote-btn btn-b" id="btn-b-${q.id}" onclick="handleVote('${q.id}', 'B')">B ì„ íƒ</button>
                    </div>
                    <div class="loading" id="load-${q.id}">íˆ¬í‘œ ë°˜ì˜ ì¤‘...</div>
                    <div class="result-bar-container" id="result-${q.id}">
                        <div class="bar-fill-a" id="bar-${q.id}"></div>
                        <div class="bar-text">
                            <span id="text-a-${q.id}">A: 0%</span>
                            <span id="text-b-${q.id}">B: 0%</span>
                        </div>
                    </div>
                </div>
            `;
            container.innerHTML += html;
        });

        // íˆ¬í‘œ ì²˜ë¦¬ í•¨ìˆ˜ (ì „ì—­ìœ¼ë¡œ ë§Œë“¤ê¸° ìœ„í•´ windowì— í• ë‹¹)
        window.handleVote = async (qId, choice) => {
            // ë²„íŠ¼ ë¹„í™œì„±í™”
            document.getElementById(`btn-a-${qId}`).disabled = true;
            document.getElementById(`btn-b-${qId}`).disabled = true;
            document.getElementById(`load-${qId}`).style.display = "block";

            // 1. Firebaseê°€ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©´ ì‹¤ì œ DB ì—…ë°ì´íŠ¸
            if (db) {
                const docRef = doc(db, "polls", qId);
                try {
                    // ë¬¸ì„œê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  ì—†ìœ¼ë©´ ìƒì„±
                    const docSnap = await getDoc(docRef);
                    if (!docSnap.exists()) {
                        await setDoc(docRef, { A: 10, B: 10 }); // ì´ˆê¸°ê°’ (0ì´ë©´ ì°ë í•˜ë‹ˆê¹Œ)
                    }

                    // íˆ¬í‘œìˆ˜ ì¦ê°€ (+1)
                    await updateDoc(docRef, {
                        [choice]: increment(1)
                    });

                    // ìµœì‹  ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                    const updatedSnap = await getDoc(docRef);
                    const data = updatedSnap.data();
                    showResult(qId, data.A, data.B);

                } catch (error) {
                    console.error("Error:", error);
                    alert("íˆ¬í‘œ ì˜¤ë¥˜! (Firebase ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”)");
                }
            } else {
                // Firebase ì—†ìœ¼ë©´ ê°€ì§œ ë™ì‘ (MVP ì‹œì—°ìš©)
                setTimeout(() => {
                    // ëœë¤í•œ ê°’ìœ¼ë¡œ ê²°ê³¼ ë³´ì—¬ì£¼ê¸°
                    const fakeA = Math.floor(Math.random() * 500) + 50;
                    const fakeB = Math.floor(Math.random() * 500) + 50;
                    showResult(qId, fakeA + (choice==='A'?1:0), fakeB + (choice==='B'?1:0));
                }, 500);
            }
        };

        function showResult(qId, countA, countB) {
            document.getElementById(`load-${qId}`).style.display = "none";
            document.getElementById(`result-${qId}`).style.display = "block";
            
            const total = countA + countB;
            const percentA = Math.round((countA / total) * 100);
            const percentB = 100 - percentA;

            document.getElementById(`bar-${qId}`).style.width = percentA + "%";
            document.getElementById(`text-a-${qId}`).innerText = `A: ${percentA}% (${countA}í‘œ)`;
            document.getElementById(`text-b-${qId}`).innerText = `B: ${percentB}% (${countB}í‘œ)`;
        }

    </script>
</body>
</html>